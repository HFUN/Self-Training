var that, globalView, myChart;
var provinces = {
'上海': 'shanghai',
'河北': 'hebei',
'山西': 'shanxi',
'内蒙古': 'neimenggu',
'辽宁': 'liaoning',
'吉林': 'jilin',
'黑龙江': 'heilongjiang',
'江苏': 'jiangsu',
'浙江': 'zhejiang',
'安徽': 'anhui',
'福建': 'fujian',
'江西': 'jiangxi',
'山东': 'shandong',
'河南': 'henan',
'湖北': 'hubei',
'湖南': 'hunan',
'广东': 'guangdong',
'广西': 'guangxi',
'海南': 'hainan',
'四川': 'sichuan',
'贵州': 'guizhou',
'云南': 'yunnan',
'西藏': 'xizang',
'陕西': 'sx',
'甘肃': 'gansu',
'青海': 'qinghai',
'宁夏': 'ningxia',
'新疆': 'xinjiang',
'北京': 'beijing',
'天津': 'tianjin',
'重庆': 'chongqing',
'香港': 'xianggang',
'澳门': 'aomen'
};
sap.ui.controller("sap.voc.view.Report.Report", {
onInit: function () {
that = this;
globalView = this.getView();
var oModel1 = new sap.ui.model.json.JSONModel("JSon/Sales_Days.json");
globalView.byId("idSalesDay").setModel(oModel1);
globalView.byId("idSalesDay").setVizProperties({
interaction: {
behaviorType: null
},
general: {
layout: {
padding: 0.1
}
},
valueAxis: {
title: {
visible: false
},
label: {
style: {
fontFamily: "Microsoft YaHei"
}
}
},
categoryAxis: {
title: {
visible: false
},
label: {
style: {
fontFamily: "Microsoft YaHei"
},
angle: 30
},
layout: {
height: 0.25
}
},
plotArea: {
isFixedDataPointSize: false,
dataPointSize: {
max: 2000
},
gap: {
visible: true
},
//            	colorPalette:{primaryAxis:['red', 'blue'], secondaryAxis:'green'},
dataLabel: {
visible: false,
style: {
fontFamily: "Microsoft YaHei"
}
},
dataShape: {
primaryAxis: ["bar", "bar"],
secondaryAxis: ["line"]
}
},
legend: {
title: {
visible: false
},
label: {
style: {
fontFamily: "Microsoft YaHei",
padding: "5px"
}
}
},
legendGroup: {
layout: {
position: "bottom",
alignment: "center"
}
},
tooltip: {
visible: true
},
title: {
visible: true,
text: "销售",
style: {
fontFamily: "Microsoft YaHei",
fontSize: "18px"
}
}
});

var oModel2 = new sap.ui.model.json.JSONModel("JSon/Product.json");
this.getView().byId("Product").setModel(oModel2);
this.getView().byId("Product").setVizProperties({
interaction: {
behaviorType: null
},
general: {
layout: {
padding: 0.1
}
},
valueAxis: {
title: {
visible: false
},
label: {
style: {
fontFamily: "Microsoft YaHei"
}
}
},
categoryAxis: {
title: {
visible: false
},
label: {
style: {
fontFamily: "Microsoft YaHei"
},
angle: 30
},
layout: {
height: 0.25
}
},
plotArea: {
isFixedDataPointSize: false,
colorPalette: ["#F4A460"],
dataLabel: {
visible: false,
style: {
fontFamily: "Microsoft YaHei"
}
},
dataShape: {
primaryAxis: "bar"
}
},
legend: {
title: {
visible: false
},
label: {
style: {
fontFamily: "Microsoft YaHei"
}
}
},
legendGroup: {
layout: {
position: "top",
alignment: "left"
}
},
tooltip: {
visible: true
},
title: {
visible: true,
text: "Sales Products Top 5",
style: {
fontFamily: "Microsoft YaHei",
fontSize: "18px"
}
}
});

var oModel3 = new sap.ui.model.json.JSONModel("JSon/SalesRep.json");
this.getView().byId("SalesRep").setModel(oModel3);
this.getView().byId("SalesRep").zoom({
direction: "in"
});
this.getView().byId("SalesRep").setVizProperties({
interaction: {
behaviorType: null
},
general: {
layout: {
padding: 0.1
}
},
valueAxis: {
title: {
visible: false
},
label: {
style: {
fontFamily: "Microsoft YaHei"
}
}
},
categoryAxis: {
title: {
visible: false
},
label: {
style: {
fontFamily: "Microsoft YaHei"
},
angle: 30
},
layout: {
height: 0.1
}
},
plotArea: {
isFixedDataPointSize: false,
colorPalette: ["#F98880"],
dataPointSize: {
max: 20
},
gap: {
barSpacing: 0.05
},
dataLabel: {
visible: false,
style: {
fontFamily: "Microsoft YaHei"
}
},
dataShape: {
primaryAxis: "bar"
}
},
legend: {
title: {
visible: false
},
label: {
style: {
fontFamily: "Microsoft YaHei"
}
}
},
legendGroup: {
layout: {
position: "top",
alignment: "left"
}
},
tooltip: {
visible: true
},
title: {
visible: true,
text: "SaLes Representative Top 5",
style: {
fontFamily: "Microsoft YaHei",
fontSize: "18px"
}
}
});
var oModel4 = new sap.ui.model.json.JSONModel("JSon/Customer.json");
this.getView().byId("Customer").setModel(oModel4);
this.getView().byId("Customer").setVizProperties({
interaction: {
behaviorType: null
},
general: {
layout: {
padding: 0.1
}
},
valueAxis: {
title: {
visible: false
},
label: {
style: {
fontFamily: "Microsoft YaHei"
}
}
},
categoryAxis: {
title: {
visible: false
},
label: {
style: {
fontFamily: "Microsoft YaHei"
},
angle: 30
},
layout: {
height: 0.1,
width: 0.3
}
},
plotArea: {
isFixedDataPointSize: false,
colorPalette: ["#7CCD7C"],
dataLabel: {
visible: false,
style: {
fontFamily: "Microsoft YaHei"
}
},
dataShape: {
primaryAxis: "bar"
}
},
legend: {
title: {
visible: false
},
label: {
style: {

fontFamily: "Microsoft YaHei"
}
}
},
legendGroup: {
layout: {
position: "top",
alignment: "left"
}
},
tooltip: {
visible: true
},
title: {
visible: true,
text: "Customers Top 5",
style: {
fontFamily: "Microsoft YaHei",
fontSize: "18px"

}
}
});
},
myOnClickHandler: function () {
var oVizFrame = this.oVizFrame = this.getView().byId("idSalesDay");
window.open("http://10.128.245.81:8007/CAH_Dashboard_2/WebContent/index2.html");
},
/*******************************************************************************************
@Desp   Mode Changing Button, dark/light
@Auth   Roy
*******************************************************************************************/
// style mode change
onModeChanged: function () {
if (this.getView().byId("modeSwitch").getState()) {
document.getElementById('cssLink').href = 'styles3_dark.css';
this.getView().byId("logo").setSrc('Image/CAH.png');

} else {
document.getElementById('cssLink').href = 'styles3_light.css';
this.getView().byId("logo").setSrc('Image/logo_dark.png');
}
},
onSetChanged: function () {
toolbarList = document.getElementsByClassName("sapSuiteUiCommonsChartContainerToolBarArea");
if (this.getView().byId("setSwitch").getState()) {
for (tb in toolbarList) {
tb.style.display = "block";
}
} else {
for (tb in toolbarList) {
tb.style.display = "none";
}
}
},
/*******************************************************************************************
Echarts

2016.09.28: 1. 地图颜色调整
2016.09.27: 1. 代码重构
2. 下钻和返回实现
2016.09.26: 1. 地图颜色控制
@Webster
*******************************************************************************************/
echartsMap: function () {
var isChinaMap = true;
var chinaOption = {
backgroundColor: '#2C3D3D',//1F2525
tooltip: {
trigger: 'item',
formatter: '{b}'
},
visualMap: {
textStyle: {
color: '#fff'
},
inRange: {
color: ['#263B3E', '#72BDF8']
},
min: 0,
max: 1000,
left: 'left',
top: 'bottom',
text: ['高', '低'],
calculable: true
},
series: [
{
name: '中国',
map: 'china',
type: 'map',
roam: true,
selectedMode: 'single',
label: {
normal: {
show: true,
textStyle: {
color: '#fff'
}
},
emphasis: {
areaColor: '#1F2525',
show: true,
textStyle: {
color: '#fff'
}
}
},
itemStyle: {
normal: {
show: true,
borderColor: '#1F2525',
areaColor: '#fff'
//shadowColor: 'rgba(0, 0, 0, 0.7)',
//shadowBlur: 8
},
emphasis: {
show: true,
areaColor: '#F98880',
textStyle: {
color: '#fff'
}
}
},
data: [
{
name: '北京',
value: randomData()
},
{
name: '天津',
value: randomData()
},
{
name: '上海',
value: randomData()
},
{
name: '重庆',
value: randomData()
},
{
name: '河北',
value: randomData()
},
{
name: '河南',
value: randomData()
},
{
name: '云南',
value: randomData()
},
{
name: '辽宁',
value: randomData()
},
{
name: '黑龙江',
value: randomData()
},
{
name: '湖南',
value: randomData()
},
{
name: '安徽',
value: randomData()
},
{
name: '山东',
value: randomData()
},
{
name: '新疆',
value: randomData()
},
{
name: '江苏',
value: randomData()
},
{
name: '浙江',
value: randomData()
},
{
name: '江西',
value: randomData()
},
{
name: '湖北',
value: randomData()
},
{
name: '广西',
value: randomData()
},
{
name: '甘肃',
value: randomData()
},
{
name: '山西',
value: randomData()
},
{
name: '内蒙古',
value: randomData()
},
{
name: '陕西',
value: randomData()
},
{
name: '吉林',
value: randomData()
},
{
name: '福建',
value: randomData()
},
{
name: '贵州',
value: randomData()
},
{
name: '广东',
value: randomData()
},
{
name: '青海',
value: randomData()
},
{
name: '西藏',
value: randomData()
},
{
name: '四川',
value: randomData()
},
{
name: '宁夏',
value: randomData()
},
{
name: '海南',
value: randomData()
},
{
name: '台湾',
value: randomData()
},
{
name: '香港',
value: randomData()
},
{
name: '澳门',
value: randomData()
}
],
scaleLimit: {
min: 1,
max: 15
}
}
]
};
function loadMap(option){
myChart = echarts.init(document.getElementById('ditusougou'));
myChart.setOption(option);
if (isChinaMap) {
showProvincesMap();
}
}
loadMap(chinaOption);
function showProvincesMap() {
//.on(eventName: string, handler: Function, context?: Object) 是 Echarts 的时间事件处理函数
myChart.on('mapselectchanged', function (params) {

var oModel3 = new sap.ui.model.json.JSONModel('JSon/SalesRep_' + provinces[params.name] + '.json');
globalView.byId("SalesRep").setModel(oModel3);
globalView.byId("SalesRep").setVizProperties({
title: {
text: 'Sales Repsentative Top 5 - ' + params.name
}
});
var oModel1 = new sap.ui.model.json.JSONModel("JSon/Sales_Days_" + provinces[params.name] + '.json');
globalView.byId("idSalesDay").setModel(oModel1);
globalView.byId("idSalesDay").setVizProperties({
title: {
text: 'Sales/Day - ' + params.name
}
});
var oModel2 = new sap.ui.model.json.JSONModel("JSon/Product_" + provinces[params.name] + '.json');
globalView.byId("Product").setModel(oModel2);
globalView.byId("Product").setVizProperties({
title: {
text: 'Sales Products Top 5 - ' + params.name
}
});
var oModel4 = new sap.ui.model.json.JSONModel("JSon/Customer_" + provinces[params.name] + '.json');
globalView.byId("Customer").setModel(oModel4);
globalView.byId("Customer").setVizProperties({
title: {
text: 'Customer Top 5 - ' + params.name
}
});
loadMap(option = {
backgroundColor: '#1F2525',
tooltip: {
trigger: 'item',
formatter: '{b}'
},
toolbox: {
itemSize: 30,
feature: {
myTool1: {
show: true,
title: '自定义扩展方法1',
icon: 'path://M432.45,595.444c0,2.177-4.661,6.82-11.305,6.82c-6.475,0-11.306-4.567-11.306-6.82s4.852-6.812,11.306-6.812C427.841,588.632,432.452,593.191,432.45,595.444L432.45,595.444z M421.155,589.876c-3.009,0-5.448,2.495-5.448,5.572s2.439,5.572,5.448,5.572c3.01,0,5.449-2.495,5.449-5.572C426.604,592.371,424.165,589.876,421.155,589.876L421.155,589.876z M421.146,591.891c-1.916,0-3.47,1.589-3.47,3.549c0,1.959,1.554,3.548,3.47,3.548s3.469-1.589,3.469-3.548C424.614,593.479,423.062,591.891,421.146,591.891L421.146,591.891zM421.146,591.891',
onclick: function (){
alert('myToolHandler1');
}
},
myTool2: {
show: true,
title: '自定义扩展方法2',
icon: 'path://M432.45,595.444c0,2.177-4.661,6.82-11.305,6.82c-6.475,0-11.306-4.567-11.306-6.82s4.852-6.812,11.306-6.812C427.841,588.632,432.452,593.191,432.45,595.444L432.45,595.444z M421.155,589.876c-3.009,0-5.448,2.495-5.448,5.572s2.439,5.572,5.448,5.572c3.01,0,5.449-2.495,5.449-5.572C426.604,592.371,424.165,589.876,421.155,589.876L421.155,589.876z M421.146,591.891c-1.916,0-3.47,1.589-3.47,3.549c0,1.959,1.554,3.548,3.47,3.548s3.469-1.589,3.469-3.548C424.614,593.479,423.062,591.891,421.146,591.891L421.146,591.891zM421.146,591.891',
onclick: function (){
alert('myToolHandler2');
}
},
saveAsImage: {}
},
iconStyle: {
normal: {
color: '#fff'
}
}
},
visualMap: {
textStyle: {
color: '#fff'
},
inRange: {
color: ['#263B3E', '#72BDF8']
},
min: 0,
max: 1000,
left: 'left',
top: 'bottom',
text: ['高', '低'],
calculable: true
},
series: [{
type: 'map',
map: params.name,
roam: true,
selectedMode: 'single',
//markpoint:
label: {
normal: {
show: true,
textStyle: {
color: '#fff'
}
},
emphasis: {
areaColor: '#1F2525',
show: true,
textStyle: {
color: '#fff'
}
}
},
itemStyle: {
normal: {
show: true,
borderColor: '#FFF',
areaColor: '#72BDF8'
//shadowColor: 'rgba(0, 0, 0, 0.7)',
//shadowBlur: 8
},
emphasis: {
show: true,
areaColor: '#F98880',
textStyle: {
color: '#fff'
}
}
},
data: [
{
name: '浦东新区',
value: randomData()
}
],
scaleLimit: {
min: 1,
max: 15
}
}]
});
isChinaMap = false;
var zr = myChart.getZr();
var backButton = new echarts.graphic.Circle({
shape: {r: 30},
style: {
text: '全国地图',
fill: '#eee'
},
position: [50, zr.getHeight() / 2]
});
var group = new echarts.graphic.Group();
group.add(backButton);
zr.add(group);
backButton.on('click', function () {
that.echartsMap();
});
});
}
function randomData() {
return Math.round(Math.random() * 1000);
}
},
onAfterRendering: function () {
setTimeout('that.echartsMap()', 1000);
}
});